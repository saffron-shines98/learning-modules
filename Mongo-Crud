import mongo
class Mongooperation:
#init is initialize methoad which called automatically when object is created , here this is use create the connection from db
    def __init__(self):
        try:
            s = mongo.client
            print("connection established", s)
        except Exception as e:
            print(e,"Unsecured connection")
#Create db collection function is creating the database and collection for mongo db
    def create_db_collection(self):
        self.db=mongo.client["mydb"]
        self.collections2=self.db["Employee_Detail"]
# Insert function we are use here to insert the data in database
    def insert(self):
        data1 = [{"_id":10,"name": "Suraj", "age": 25, "sirname": "kesarwani"},
                 {"_id":11,"name": "Rj", "age": 27, "sirname": "Jaiswal"},
                 {"_id":12,"name": "Raj", "age": 15, "sirname": "verma"},
                 {"_id":13,"name": "loon", "age": 25, "sirname": "Shah"},
                 {"_id":14,"name": "hansh", "age": 22, "sirname": "Singh"},
                 {"_id":15,"name": "Jade", "age": 28, "sirname": "khan"},
                 {"_id":16,"name": "Amin", "age": 23, "sirname": "Singh"}]
        self.collections2.insert_many(data1)
        print("Data inserted")
#Read funtion is used to fetch the data from the collection by using find_one/many function
    def Read(self):
        info=self.collections2.find()
        for i in info:
            print(i)
        # info=self.collections2.find_one({"name":"Raj"})

#update function is used to update the values here from the collection
    def update(self):
        previous={"name":"Raj"}
        nextt={"$set":{"age":32}}
        self.collections2.update_one(previous,nextt)
        print("Values are updated")
#delete funtion is used to remove the data from the collection by using delete_one/many funtion
    def delete(self):
        record={"_id":16}    # here i am delete the document accordingly unqiuely identified id
        self.collections2.delete_one(record)
        print("Values are deleted")
#main funtion is used to call the funtion accordingly
    def main(self):
        self.create_db_collection()
        # self.insert()
        # self.update()
        # self.delete()
        self.Read()


obj=Mongooperation()
obj.main()









